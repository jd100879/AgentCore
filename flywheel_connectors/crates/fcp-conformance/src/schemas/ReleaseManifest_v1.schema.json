{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "fcp://schemas/release-manifest/v1",
  "title": "FCP ReleaseManifest v1",
  "type": "object",
  "required": [
    "format",
    "schema_version",
    "connector_id",
    "version",
    "digest",
    "channel",
    "required_caps",
    "min_host_version",
    "signed_by",
    "signature"
  ],
  "additionalProperties": false,
  "properties": {
    "format": { "const": "fcp-release-manifest" },
    "schema_version": { "const": "1.0" },
    "connector_id": {
      "type": "string",
      "minLength": 1,
      "pattern": "^[a-z0-9][a-z0-9._:-]*$"
    },
    "version": {
      "type": "string",
      "minLength": 1
    },
    "digest": {
      "type": "string",
      "pattern": "^blake3-256:[a-f0-9]{64}$"
    },
    "channel": {
      "type": "string",
      "minLength": 1
    },
    "required_caps": {
      "type": "array",
      "items": { "type": "string", "minLength": 1 },
      "uniqueItems": true
    },
    "min_host_version": {
      "type": "string",
      "minLength": 1
    },
    "signed_by": {
      "type": "string",
      "minLength": 1
    },
    "created_at": {
      "type": "string",
      "format": "date-time"
    },
    "signature": {
      "type": "object",
      "required": ["algorithm", "key_id", "signature", "signed_fields"],
      "additionalProperties": false,
      "properties": {
        "algorithm": { "const": "ed25519" },
        "key_id": {
          "type": "string",
          "minLength": 1
        },
        "signature": {
          "type": "string",
          "minLength": 1
        },
        "signed_fields": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string" }
        }
      }
    }
  }
}
